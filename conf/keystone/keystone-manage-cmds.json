# This is a extended json package definition file 
# We allow simple comments (lines starting with a hash symbol)
# 
# These commands will be used when setting up keystone. They will be invoked by the keystone-manage command.
# Different sections of the following json may or may not be activated (depending on which other components are to be setup.
#
# Options like %ADMIN_PASSWORD% will be filled in with an actual value.
#
# Command ordering may matter, so be careful!
#
# Based off of commit 30439a6dc4 of keystone_data.sh
{
    # Users
    "users": [
        [
            "user",
            "add",
            "admin",
            "%ADMIN_PASSWORD%"
        ],
        [
            "user",
            "add",
            "demo",
            "%ADMIN_PASSWORD%"
        ]
    ],
    # Roles
    "roles": [
        [
            "role",
            "add",
            "admin"
        ],
        [
            "role",
            "add",
            "Member"
        ],
        [
            "role",
            "add",
            "KeystoneAdmin"
        ],
        [
            "role",
            "add",
            "KeystoneServiceAdmin"
        ],
        [
            "role",
            "add",
            "sysadmin"
        ],
        [
            "role",
            "add",
            "netadmin"
        ],
        [
            "role",
            "grant",
            "admin",
            "admin",
            "admin"
        ],
        [
            "role",
            "grant",
            "Member",
            "demo",
            "demo"
        ],
        [
            "role",
            "grant",
            "sysadmin",
            "demo",
            "demo"
        ],
        [
            "role",
            "grant",
            "netadmin",
            "demo",
            "demo"
        ],
        [
            "role",
            "grant",
            "Member",
            "demo",
            "invisible_to_admin"
        ],
        [
            "role",
            "grant",
            "admin",
            "admin",
            "demo"
        ],
        [
            "role",
            "grant",
            "admin",
            "admin"
        ],
        [
            "role",
            "grant",
            "KeystoneAdmin",
            "admin"
        ],
        [
            "role",
            "grant",
            "KeystoneServiceAdmin",
            "admin"
        ]
    ],
    "swift": [
        # Swift service
        [
            "service",
            "add",
            "swift",
            "object-store",
            "\"Swift Service\""
        ],
        # Endpoint template for swift
        [
            "endpointTemplates",
            "add",
            "RegionOne",
            "swift",
            "http://%SERVICE_HOST%:8080/v1/AUTH_%tenant_id%",
            "http://%SERVICE_HOST%:8080/",
            "http://%SERVICE_HOST%:8080/v1/AUTH_%tenant_id%",
            "1",
            "1"
        ]
    ],
    "nova": [
        # Nova service
        [
            "service",
            "add",
            "nova",
            "compute",
            "\"Nova Compute Service\""
        ],
        # EC2 service
        [
            "service",
            "add",
            "ec2",
            "ec2",
            "\"EC2 Compatability Layer\""
        ],
        # Endpoint template for nova
        [
            "endpointTemplates",
            "add",
            "RegionOne",
            "nova",
            "http://%SERVICE_HOST%:8774/v1.1/%tenant_id%",
            "http://%SERVICE_HOST%:8774/v1.1/%tenant_id%",
            "http://%SERVICE_HOST%:8774/v1.1/%tenant_id%",
            "1",
            "1"
        ],
        # Endpoint template for ec2
        [
            "endpointTemplates",
            "add",
            "RegionOne",
            "ec2",
            "http://%SERVICE_HOST%:8773/services/Cloud",
            "http://%SERVICE_HOST%:8773/services/Admin",
            "http://%SERVICE_HOST%:8773/services/Cloud",
            "1",
            "1"
        ],
        # EC2 related creds - note we are setting the secret key to ADMIN_PASSWORD
        # but keystone doesn't parse them - it is just a blob from keystone's
        # point of view.
        [
            "credentials",
            "add",
            "admin",
            "EC2",
            "admin",
            "%ADMIN_PASSWORD%",
            "admin"
        ],
        [
            "credentials",
            "add",
            "demo",
            "EC2",
            "demo",
            "%ADMIN_PASSWORD%",
            "demo"
        ]
    ],
    # Tokens
    "tokens": [
        [
            "token",
            "add",
            "%SERVICE_TOKEN%",
            "admin",
            "admin",
            "2015-02-05T00:00"
        ]
    ],
    # Services
    "services": [
        # Keystone Service
        [
            "service",
            "add",
            "keystone",
            "identity",
            "\"Keystone Identity Service\""
        ]
    ],
    "glance": [
        # Glance service
        [
            "service",
            "add",
            "glance",
            "image",
            "\"Glance Image Service\""
        ],
        # Endpoint template for glance
        [
            "endpointTemplates",
            "add",
            "RegionOne",
            "glance",
            "http://%SERVICE_HOST%:9292/v1",
            "http://%SERVICE_HOST%:9292/v1",
            "http://%SERVICE_HOST%:9292/v1",
            "1",
            "1"
        ]
    ],
    # Endpoint template for keystone
    "endpoints": [
        [
            "endpointTemplates",
            "add",
            "RegionOne",
            "keystone",
            "%KEYSTONE_SERVICE_PROTOCOL%://%KEYSTONE_SERVICE_HOST%:%KEYSTONE_SERVICE_PORT%/v2.0",
            "%KEYSTONE_AUTH_PROTOCOL%://%KEYSTONE_AUTH_HOST%:%KEYSTONE_AUTH_PORT%/v2.0",
            "%KEYSTONE_SERVICE_PROTOCOL%://%KEYSTONE_SERVICE_HOST%:%KEYSTONE_SERVICE_PORT%/v2.0",
            "1",
            "1"
        ]
    ],
    # Tenants
    "tenants": [
        [
            "tenant",
            "add",
            "admin"
        ],
        [
            "tenant",
            "add",
            "demo"
        ],
        [
            "tenant",
            "add",
            "invisible_to_admin"
        ]
    ]
}
